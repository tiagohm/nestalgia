package br.tiagohm.nestalgia.core

import org.slf4j.LoggerFactory
import java.io.IOException

object MapperFactory {

    const val FDS_MAPPER_ID = 65535

    @JvmStatic private val LOG = LoggerFactory.getLogger(MapperFactory::class.java)

    @JvmStatic
    fun from(data: RomData): Mapper {
        return when (val id = data.info.mapperId) {
            0 -> NROM()
            1 -> MMC1()
            2 -> UNROM()
            3 -> Mapper003()
            4 -> if (data.info.subMapperId == 3) McAcc() else MMC3()
            6 -> Mapper006()
            7 -> AXROM()
            8 -> Mapper008()
            9 -> MMC2()
            10 -> MMC4()
            11 -> ColorDreams()
            12 -> Mapper012()
            13 -> CpRom()
            14 -> Mapper014()
            15 -> Mapper015()
            16 -> Mapper016()
            17 -> Mapper017()
            28 -> Action53()
            29 -> SealieComputing()
            30 -> UnRom512()
            31 -> NsfCart31()
            33 -> TaitoTc0190()
            34 -> {
                when (val sid = data.info.subMapperId) {
                    // BnROM uses CHR RAM (so no CHR rom in the NES file)
                    0 -> if (data.chrRom.isEmpty()) BnRom() else Nina01()
                    1 -> Nina01()
                    2 -> BnRom()
                    else -> throw IOException("Unsupported mapper $id with submapper $sid")
                }
            }
            36 -> Txc22000()
            37 -> Mapper037()
            38 -> UnlPci556()
            39 -> Mapper039()
            40 -> Mapper040()
            42 -> Mapper042()
            44 -> Mapper044()
            45 -> Mapper045()
            46 -> ColorDreams46()
            47 -> Mapper047()
            49 -> Mapper049()
            52 -> Mapper052()
            63 -> Bmc63()
            71 -> BF909x()
            74 -> Mapper074()
            76 -> Mapper076()
            79 -> Nina0306(false)
            87 -> Mapper087()
            88 -> Mapper088()
            91 -> Mapper091()
            95 -> Mapper095()
            96 -> OekaKids()
            97 -> IremTamS1()
            101 -> Mapper101()
            104 -> GoldenFive()
            105 -> Mapper105()
            106 -> Mapper106()
            107 -> Mapper107()
            108 -> Bb()
            111 -> Cheapocabra()
            113 -> Nina0306(true)
            114 -> Mapper114()
            115 -> Mapper115()
            118 -> TxSRom()
            119 -> Mapper119()
            121 -> Mapper121()
            123 -> Mapper123()
            132 -> Txc22211a()
            133 -> Sachen133()
            134 -> Mapper134()
            136 -> Sachen136()
            143 -> Sachen143()
            144 -> Mapper144()
            145 -> Sachen145()
            146 -> Nina0306(false)
            147 -> Sachen147()
            148 -> Sachen148()
            149 -> Sachen149()
            153 -> Mapper153()
            154 -> Mapper154()
            155 -> Mapper155()
            157 -> Mapper157()
            159 -> Mapper159()
            162 -> Waixing162()
            164 -> Waixing164()
            172 -> Txc22211b()
            173 -> Txc22211c()
            177 -> Henggedianzi177()
            178 -> Waixing178()
            179 -> Henggedianzi179()
            185 -> Mapper185()
            190 -> MagicKidGooGoo()
            191 -> Mapper191()
            192 -> Mapper192()
            194 -> Mapper194()
            195 -> Mapper195()
            196 -> Mapper196()
            197 -> Mapper197()
            198 -> Mapper198()
            199 -> Mapper199()
            200 -> Mapper200()
            206 -> Namco108()
            213 -> Mapper213()
            214 -> Mapper214()
            218 -> MagicFloor218()
            219 -> Mapper219()
            232 -> BF9096()
            235 -> Bmc235()
            238 -> Mapper238()
            240 -> Mapper240()
            241 -> Mapper241()
            242 -> Mapper242()
            244 -> Mapper244()
            245 -> Mapper245()
            246 -> Mapper246()
            249 -> Mapper249()
            250 -> Mapper250()
            252 -> Waixing252()
            253 -> Mapper253()
            254 -> Mapper254()
            255 -> Bmc255()
            286 -> Bs5()
            328 -> Rt01()
            FDS_MAPPER_ID -> Fds()
            32770 -> Gs2013()
            else -> {
                LOG.error("{} has unsupported mapper id={}", data.info.name, id)
                throw IOException("Unsupported mapper $id")
            }
        }
    }
}
